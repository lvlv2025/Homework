# Flask API æ–‡æ¡£

æœ¬é¡¹ç›®æä¾›äº†ç”¨æˆ·ä¸ç®¡ç†å‘˜çš„ç™»å½•ã€æ³¨å†Œã€èŠå¤©ã€ä¸ªäººä¿¡æ¯ç­‰æ¥å£ã€‚

------------------------------------------------------------------------

## ğŸ”‘ ç”¨æˆ·è®¤è¯æ¥å£

### 1. ç”¨æˆ·æ³¨å†Œ

-   **URL**: `/api/register`

-   **æ–¹æ³•**: `POST`

-   **å‚æ•°**:

    ``` json
    {
      "username": "ç”¨æˆ·å",
      "password": "å¯†ç ",
      "email": "é‚®ç®±",
      "captcha": "éªŒè¯ç "
    }
    ```

-   **è¿”å›**:

    ``` json
    {
      "success": true,
      "message": "æ³¨å†ŒæˆåŠŸ",
      "user_uuid": "å”¯ä¸€ç”¨æˆ·ID"
    }
    ```

### 2. ç”¨æˆ·ç™»å½•

-   **URL**: `/api/login`

-   **æ–¹æ³•**: `POST`

-   **å‚æ•°**:

    ``` json
    {
      "username": "ç”¨æˆ·å",
      "password": "å¯†ç ",
      "captcha": "éªŒè¯ç ",
      "remember": true
    }
    ```

-   **è¿”å›**:

    ``` json
    {
      "success": true,
      "message": "ç™»å½•æˆåŠŸ",
      "username": "ç”¨æˆ·å",
      "token": "JWTä»¤ç‰Œ"
    }
    ```

### 3. ç”¨æˆ·ç™»å‡º

-   **URL**: `/api/logout`

-   **æ–¹æ³•**: `POST`

-   **è¿”å›**:

    ``` json
    {
      "success": true,
      "message": "ç™»å‡ºæˆåŠŸ",
      "uuid": "ç”¨æˆ·ID"
    }
    ```

### 4. è·å–éªŒè¯ç 

-   **URL**:
    -   æ³¨å†ŒéªŒè¯ç : `/api/register/captcha`
    -   ç™»å½•éªŒè¯ç : `/api/login/captcha`
-   **æ–¹æ³•**: `GET`
-   **è¿”å›**: PNGå›¾ç‰‡ï¼ˆäºŒè¿›åˆ¶æµï¼‰

------------------------------------------------------------------------

## ğŸ’¬ èŠå¤©æ¥å£

### 1. å‘é€æ¶ˆæ¯å¹¶è·å–å›å¤

-   **URL**: `/api/chat/get_response`

-   **æ–¹æ³•**: `POST`

-   **å‚æ•°**:

    ``` json
    {
      "text": "ç”¨æˆ·è¾“å…¥",
      "topic_id": "è¯é¢˜ID(å¯é€‰),ç¬¬ä¸€æ¬¡ä¸ç”¨æºå¸¦"
    }
    ```

-   **è¿”å›**:

    ``` json
    {
      "success": true,
      "reply": "AIå›ç­”",
      "topic_id": "è¯é¢˜ID"
    }
    ```

### 2. å¼€å¯æ–°è¯é¢˜

-   **URL**: `/api/chat/update_chat`

-   **æ–¹æ³•**: `POST`

-   **å‚æ•°**:

    ``` json
    { "new": true }
    ```

-   **è¿”å›**:

    ``` json
    {
      "success": true,
      "message": "æ–°è¯é¢˜å·²å¼€å§‹",
      "topic_id": "è¯é¢˜ID",
      "chat_history": [
        {"role": "system", "content": "You are a helpful assistant"}
      ]
    }
    ```

### 3. è·å–ç”¨æˆ·æ‰€æœ‰å†å²å¯¹è¯

-   **URL**: `/api/chat/history_response`

-   **æ–¹æ³•**: `POST`

-   **å‚æ•°**:

    ``` json
    { "user_uuid": "ç”¨æˆ·ID" }
    ```

-   **è¿”å›ç¤ºä¾‹**:

    ``` json
    {
      "history": [
        {
          "topic_id": "123456",
          "user_question": {
            "role": "user",
            "content": "ä½ å¥½"
          },
          "assistant_reply": {
            "role": "assistant",
            "content": "ä½ å¥½ï¼Œæˆ‘èƒ½å¸®ä½ ä»€ä¹ˆï¼Ÿ"
          }
        },
        {
          "topic_id": "654321",
          "user_question": {
            "role": "user",
            "content": "å¸®æˆ‘å†™ä¸ªPythonä»£ç "
          },
          "assistant_reply": {
            "role": "assistant",
            "content": "å¥½çš„ï¼Œè¿™é‡Œæ˜¯ç¤ºä¾‹ä»£ç ..."
          }
        }
      ]
    }
    ```

### 4. è·å–æŸä¸€è¯é¢˜çš„å®Œæ•´å¯¹è¯

-   **URL**: `/api/chat/Specific_history`

-   **æ–¹æ³•**: `POST`

-   **å‚æ•°**:

    ``` json
    {
      "user_uuid": "ç”¨æˆ·ID",
      "topic_id": "è¯é¢˜ID"
    }
    ```

-   **è¿”å›ç¤ºä¾‹**:

    ``` json
    {
      "reply": [
        { "role": "user", "content": "ä½ å¥½" },
        { "role": "assistant", "content": "ä½ å¥½ï¼Œæˆ‘èƒ½å¸®ä½ ä»€ä¹ˆï¼Ÿ" },
        { "role": "user", "content": "ç»™æˆ‘è§£é‡Šä¸‹Flaskæ˜¯ä»€ä¹ˆ" },
        { "role": "assistant", "content": "Flask æ˜¯ä¸€ä¸ª Python Web æ¡†æ¶..." }
      ]
    }
    ```

------------------------------------------------------------------------

## ğŸ‘¤ ç”¨æˆ·ä¿¡æ¯æ¥å£

### 1. è·å–å½“å‰ç”¨æˆ·ä¿¡æ¯

-   **URL**: `/api/get_info/user`

-   **æ–¹æ³•**: `POST`

-   **è¿”å›**:

    ``` json
    {
      "success": true,
      "message": "ç”¨æˆ·ä¿¡æ¯æŸ¥è¯¢æˆåŠŸ",
      "data": {
        "user_id": "ç”¨æˆ·ID",
        "username": "ç”¨æˆ·å",
        "email": "é‚®ç®±"
      }
    }
    ```

------------------------------------------------------------------------

## ğŸ‘¨â€ğŸ’¼ ç®¡ç†å‘˜æ¥å£

### 1. ç®¡ç†å‘˜ç™»å½•

-   **URL**: `/api/login/admin`

-   **æ–¹æ³•**: `POST`

-   **å‚æ•°**:

    ``` json
    {
      "Admin_name": "ç®¡ç†å‘˜ç”¨æˆ·å",
      "password": "å¯†ç "
    }
    ```

### 2. åˆ›å»ºç®¡ç†å‘˜

-   **URL**: `/api/creat_info/admin`

-   **æ–¹æ³•**: `POST`

-   **å‚æ•°**:

    ``` json
    {
      "username": "ç®¡ç†å‘˜ç”¨æˆ·å",
      "password": "å¯†ç "
    }
    ```

### 3. è·å–ç®¡ç†å‘˜ä¿¡æ¯

-   **URL**: `/api/get_info/admin`

-   **æ–¹æ³•**: `POST`

-   **å‚æ•°**:

    ``` json
    { "Admin_name": "ç®¡ç†å‘˜ç”¨æˆ·å" }
    ```

------------------------------------------------------------------------

## âš™ï¸ æ—¥å¿—

-   æ—¥å¿—æ–‡ä»¶è·¯å¾„ï¼š`logs/app.log`
-   æ§åˆ¶å°ä¸æ–‡ä»¶åŒæ—¶è¾“å‡º
-   æœ€å¤§å¤§å°ï¼š5MBï¼Œä¿ç•™ 5 ä¸ªå¤‡ä»½

------------------------------------------------------------------------

## ğŸš€ å¯åŠ¨æ–¹å¼

``` bash
python app.py
```

æœåŠ¡å¯åŠ¨åé»˜è®¤è¿è¡Œåœ¨: `http://0.0.0.0:5000`
